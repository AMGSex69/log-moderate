# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò –û–§–ò–°–ê

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ—Ñ–∏—Å–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤ –∞–¥–º–∏–Ω–∫–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å –º–µ–∂–¥—É:
- ‚ùå –ê–¥–º–∏–Ω–∫–æ–π (—Ç–∞–±–ª–∏—Ü–∞ `employees`)  
- ‚ùå –ü—Ä–æ—Ñ–∏–ª–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç–∞–±–ª–∏—Ü–∞ `user_profiles`)
- ‚ùå –ì–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π (–ª–∏–¥–µ—Ä–±–æ—Ä–¥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏—Å—å **—Ç—Ä–∏ —Ä–∞–∑–Ω—ã—Ö –æ—Ñ–∏—Å–∞** –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## –†–µ—à–µ–Ω–∏–µ

### 1. üóÉÔ∏è SQL –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤ Supabase Dashboard)

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–π–ª `sql/fix-office-sync-issue.sql` –≤ Supabase Dashboard ‚Üí SQL Editor:

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `update_employee_permissions` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ `office_name`
- ‚úÖ –î–æ–±–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ –æ—Ñ–∏—Å–∞
- ‚úÖ –°–æ–∑–¥–∞–µ—Ç —Ç—Ä–∏–≥–≥–µ—Ä –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ `office_name` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `offices`
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏

### 2. üéØ Frontend –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∞–¥–º–∏–Ω–∫–∏** (`components/admin/employee-management.tsx`):
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ `officeChanged` –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ—Ñ–∏—Å–∞
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

**–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞** (`app/page.tsx`):  
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Å–ª—É—à–∞—Ç–µ–ª—å —Å–æ–±—ã—Ç–∏—è `officeChanged`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ –∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–± —É—Å–ø–µ—à–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –®–∞–≥ 1: –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL
```bash
# –í Supabase Dashboard ‚Üí SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
sql/fix-office-sync-issue.sql
```

### –®–∞–≥ 2: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```bash
npm run dev
```

### –®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. **–í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** –≤ –∞–¥–º–∏–Ω–∫—É
2. **–°–º–µ–Ω–∏—Ç–µ –æ—Ñ–∏—Å** —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å "–†–∞—Å—Å–≤–µ—Ç" –Ω–∞ "–¢—É–ª—å—Å–∫–∞—è")
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é:**
   - üîç –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–π –æ—Ñ–∏—Å
   - üîç –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –æ–±–Ω–æ–≤–∏—Ç—å –ª–∏–¥–µ—Ä–±–æ—Ä–¥
   - üîç –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–û—Ñ–∏—Å –æ–±–Ω–æ–≤–ª—ë–Ω"

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- `user_profiles.office_id` + `user_profiles.office_name` —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- `employees.office_id` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- `employees_leaderboard` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

### –§—Ä–æ–Ω—Ç–µ–Ω–¥  
- –°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π DOM –¥–ª—è –º–µ–∂–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–æ–π —Å–≤—è–∑–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

## –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

–°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
```
üè¢ [–ê–î–ú–ò–ù–ö–ê] –û—Ñ–∏—Å –∏–∑–º–µ–Ω—ë–Ω —Å 1 –Ω–∞ 2
üì° [–ê–î–ú–ò–ù–ö–ê] –°–æ–±—ã—Ç–∏–µ officeChanged –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ  
üè¢ [–ì–õ–ê–í–ù–ê–Ø] –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ñ–∏—Å–∞
‚ú® [–ì–õ–ê–í–ù–ê–Ø] –û—Ñ–∏—Å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑–º–µ–Ω—ë–Ω, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ...
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç** - –æ—Ñ–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö –º–µ—Å—Ç–∞—Ö:
- –ê–¥–º–∏–Ω–∫–∞ ‚ÜîÔ∏è –ü—Ä–æ—Ñ–∏–ª—å ‚ÜîÔ∏è –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

‚úÖ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

‚úÖ **–õ–∏–¥–µ—Ä–±–æ—Ä–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è** –¥–ª—è –Ω–æ–≤–æ–≥–æ –æ—Ñ–∏—Å–∞

‚úÖ **–ù–µ—Ç –∑–∞–¥–µ—Ä–∂–µ–∫** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ

---

**–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞! üéâ**

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ—Ñ–∏—Å–∞ –≤ –∞–¥–º–∏–Ω–∫–µ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. 