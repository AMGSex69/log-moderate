# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ì–†–ê–§–ò–ö–û–í –í –ü–†–û–§–ò–õ–ï

## –ü—Ä–æ–±–ª–µ–º–∞
–í –ø—Ä–æ—Ñ–∏–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å **—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–Ω—è–º —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏**, –Ω–æ –æ–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –¥–∞–Ω–Ω—ã–µ **–∏–∑ –≤—Å–µ—Ö –æ—Ñ–∏—Å–æ–≤**, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–æ–≥–¥–∞-–ª–∏–±–æ —Ä–∞–±–æ—Ç–∞–ª, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –æ—Ñ–∏—Å–∞.

–ü—Ä–∏ —Å–º–µ–Ω–µ –æ—Ñ–∏—Å–∞ –≤ –∞–¥–º–∏–Ω–∫–µ –≥—Ä–∞—Ñ–∏–∫–∏ **–ù–ï –æ–±–Ω–æ–≤–ª—è–ª–∏—Å—å** –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ.

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### üîç **–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
1. **fetchDailyStats()** - –≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ –¥–Ω—è–º –Ω–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–ª–∏—Å—å –ø–æ –æ—Ñ–∏—Å—É
2. **fetchUserStats()** - –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∞ –æ—Ñ–∏—Å  
3. **fetchTaskHistory()** - –∏—Å—Ç–æ—Ä–∏—è –∑–∞–¥–∞—á –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –≤—Å–µ –æ—Ñ–∏—Å—ã
4. **–û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª —Å–ª—É—à–∞—Ç–µ–ª—å —Å–æ–±—ã—Ç–∏–π** –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ñ–∏—Å–∞ –≤ –ø—Ä–æ—Ñ–∏–ª–µ

### ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

#### 1. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –ø–æ –æ—Ñ–∏—Å—É**
```typescript
// –ë–´–õ–û:
const { data, error } = await supabase
    .from("task_logs")
    .select("work_date, units_completed, time_spent_minutes")
    .eq("employee_id", employeeId)

// –°–¢–ê–õ–û:
const { data, error } = await supabase
    .from("task_logs")
    .select(`
        work_date, 
        units_completed, 
        time_spent_minutes,
        employees!inner(office_id)
    `)
    .eq("employee_id", employeeId)
    .eq("employees.office_id", currentOfficeId) // ‚Üê –§–∏–ª—å—Ç—Ä –ø–æ –æ—Ñ–∏—Å—É!
```

#### 2. **–î–æ–±–∞–≤–ª–µ–Ω —Å–ª—É—à–∞—Ç–µ–ª—å —Å–æ–±—ã—Ç–∏–π –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ñ–∏—Å–∞**
```typescript
useEffect(() => {
    const handleOfficeChange = async (event: Event) => {
        const { userId } = customEvent.detail
        
        if (userId === user.id) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è
            await refreshUserData()
            await fetchOfficeStats()
            await fetchDailyStats()      // ‚Üê –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫–∏!
            await fetchProfileInfo()
            
            toast({
                title: "–û—Ñ–∏—Å –æ–±–Ω–æ–≤–ª—ë–Ω",
                description: "–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∏ –≥—Ä–∞—Ñ–∏–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å –Ω–æ–≤—ã–º –æ—Ñ–∏—Å–æ–º",
            })
        }
    }

    window.addEventListener('officeChanged', handleOfficeChange)
    return () => window.removeEventListener('officeChanged', handleOfficeChange)
}, [user])
```

#### 3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏**
- ‚úÖ `fetchDailyStats()` - –≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ –¥–Ω—è–º
- ‚úÖ `fetchUserStats()` - –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞  
- ‚úÖ `fetchTaskHistory()` - –∏—Å—Ç–æ—Ä–∏—è –∑–∞–¥–∞—á

## –†–µ–∑—É–ª—å—Ç–∞—Ç

### üéØ **–¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
1. **–ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–µ–≥–æ –æ—Ñ–∏—Å–∞**
2. **–ü—Ä–∏ —Å–º–µ–Ω–µ –æ—Ñ–∏—Å–∞ –≤ –∞–¥–º–∏–Ω–∫–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è**
3. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –º–µ–∂–¥—É –≤—Å–µ–º–∏ —á–∞—Å—Ç—è–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏**

### üìä **–ß—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –æ—Ñ–∏—Å–∞:**
- üìà **–ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ –¥–Ω—è–º** (–µ–¥–∏–Ω–∏—Ü—ã, –≤—Ä–µ–º—è, –∑–∞–¥–∞—á–∏)
- üìä **–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** (–≤—Å–µ–≥–æ –∑–∞–¥–∞—á, –≤—Ä–µ–º–µ–Ω–∏, –µ–¥–∏–Ω–∏—Ü)
- üìã **–ò—Å—Ç–æ—Ä–∏—è –∑–∞–¥–∞—á** (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 –∑–∞–ø–∏—Å–µ–π)
- üè¢ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ñ–∏—Å–∞** (–∫–æ–º–∞–Ω–¥–∞, —Ä–∞–±–æ—Ç–∞—é—â–∏–µ —Å–µ–π—á–∞—Å)
- üë§ **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è** (–Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ñ–∏—Å–∞)

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å** ‚Üí –≤–∫–ª–∞–¥–∫–∞ "–û—Ñ–∏—Å" ‚Üí –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∏
2. **–ó–∞–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω–∫—É** ‚Üí –∏–∑–º–µ–Ω–∏—Ç–µ –æ—Ñ–∏—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
3. **–í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –ø—Ä–æ—Ñ–∏–ª—å** ‚Üí –≥—Ä–∞—Ñ–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –æ–±–Ω–æ–≤–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å** - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –ª–æ–≥–∏:
   ```
   üè¢ [–ü–†–û–§–ò–õ–¨] –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ñ–∏—Å–∞
   ‚ú® [–ü–†–û–§–ò–õ–¨] –û—Ñ–∏—Å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑–º–µ–Ω—ë–Ω, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ...
   üìä [PROFILE-DAILY] –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –¥–Ω—è–º –¥–ª—è –æ—Ñ–∏—Å–∞: 2
   ```

–¢–µ–ø–µ—Ä—å **–≤—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –ø—Ä–æ—Ñ–∏–ª–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –ø–æ —Ç–µ–∫—É—â–µ–º—É –æ—Ñ–∏—Å—É** –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –µ–≥–æ —Å–º–µ–Ω–µ! üéâ 