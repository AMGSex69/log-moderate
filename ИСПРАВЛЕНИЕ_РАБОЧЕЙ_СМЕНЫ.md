# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–∞–±–æ—á–µ–π —Å–º–µ–Ω–æ–π

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å –ø—Ä–æ–±–ª–µ–º–æ–π, –∫–æ–≥–¥–∞ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "–ù–∞—á–∞—Ç—å —Ä–∞–±–æ—á—É—é —Å–º–µ–Ω—É" —Å–º–µ–Ω–∞ –Ω–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è, —Ö–æ—Ç—è –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å –Ω–∞—á–∞—Ç.

**–ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã:**
–í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ `work_sessions` –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã (`clock_out_time`) —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤—Ä–µ–º—è —Ä–∞–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã (`clock_in_time`). –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞:
1. –í—á–µ—Ä–∞ –≤—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ 05:43)
2. –°–µ–≥–æ–¥–Ω—è –≤—ã –Ω–∞—á–∞–ª–∏ –Ω–æ–≤—ã–π –¥–µ–Ω—å (–≤ 15:45)
3. –ù–æ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ —Å–±—Ä–æ—Å–∏–ª–∞ —Å—Ç–∞—Ä–æ–µ –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è

–ò–∑ –≤–∞—à–∏—Ö –ª–æ–≥–æ–≤:
```
clock_in_time: "2025-06-02T15:45:37.553+00:00"  // –°–µ–≥–æ–¥–Ω—è 15:45
clock_out_time: "2025-06-02T05:43:13.522+00:00"  // –í—á–µ—Ä–∞ 05:43
```

–õ–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ –≤—ã "–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç–µ", –ø–æ—Ç–æ–º—É —á—Ç–æ –µ—Å—Ç—å `clock_out_time`.

## –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ SQL (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)

1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ SQL Editor
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç `fix-work-session-issue.sql`

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- –ù–∞–π–¥–µ—Ç –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å–µ—Å—Å–∏–∏
- –ò—Å–ø—Ä–∞–≤–∏—Ç –∏—Ö (—Å–±—Ä–æ—Å–∏—Ç `clock_out_time` –Ω–∞ `NULL`)
- –£–¥–∞–ª–∏—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏–µ —Å–µ—Å—Å–∏–∏
- –ü–æ–∫–∞–∂–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ SQL Editor:

```sql
-- –ù–∞–π—Ç–∏ –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º–Ω—É—é —Å–µ—Å—Å–∏—é
SELECT * FROM work_sessions 
WHERE date = CURRENT_DATE 
  AND clock_out_time < clock_in_time;

-- –ò—Å–ø—Ä–∞–≤–∏—Ç—å (—Å–±—Ä–æ—Å–∏—Ç—å clock_out_time)
UPDATE work_sessions 
SET clock_out_time = NULL 
WHERE date = CURRENT_DATE 
  AND clock_out_time < clock_in_time;
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

1. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. –ö–æ–¥ —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–∂–∞—Ç—å "–ù–∞—á–∞—Ç—å —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å" –µ—â–µ —Ä–∞–∑
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –ª–æ–≥–∏:
   - `üìù handleClockIn: –°–µ—Å—Å–∏—è –î–û –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:`
   - `‚úÖ handleClockIn: –°–µ—Å—Å–∏—è –ü–û–°–õ–ï –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:`

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥–µ

1. **–î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏** –≤ —Ñ—É–Ω–∫—Ü–∏—é `handleClockIn` –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** - —Ç–µ–ø–µ—Ä—å `clock_out_time` —è–≤–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ `null`
3. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞** –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–∞–∑—ã
4. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ TypeScript** –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

1. –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
   ```
   üéØ –°—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã: –†–∞–±–æ—Ç–∞–µ—Ç
   üíº –ù–∞–π–¥–µ–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Å–µ—Å—Å–∏–π: 1
   ```

2. –ö–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å" –¥–æ–ª–∂–Ω–∞ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –Ω–∞ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—á–µ–π —Å–º–µ–Ω–æ–π

3. –í—ã —Å–º–æ–∂–µ—Ç–µ –Ω–∞—á–∏–Ω–∞—Ç—å –∑–∞–¥–∞—á–∏

## –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ –±—É–¥—É—â–µ–º

–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –Ω–∞—á–∞–ª–µ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è —Å—Ç–∞—Ä–æ–µ –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –Ω–µ –≤—Å–µ–≥–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞–ª–æ—Å—å. –¢–µ–ø–µ—Ä—å –∫–æ–¥:

1. **–Ø–≤–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç** —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ—Å—Å–∏—é
2. **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç** `clock_out_time` –≤ `null`
3. **–õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

## –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–≤—Ç–æ—Ä–∏—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
   ```sql
   SELECT 
       id, employee_id, date, clock_in_time, clock_out_time,
       CASE 
           WHEN clock_in_time IS NOT NULL AND clock_out_time IS NULL THEN '–í —Ä–∞–±–æ—Ç–µ'
           WHEN clock_out_time < clock_in_time THEN '–ü–†–û–ë–õ–ï–ú–ê'
           ELSE '–û–ö'
       END as status
   FROM work_sessions 
   WHERE date = CURRENT_DATE;
   ```

3. –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, –≤–æ–∑–º–æ–∂–Ω–æ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å RLS –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏ –≤ Supabase 